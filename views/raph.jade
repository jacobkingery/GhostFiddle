extends layout

block header_scripts

    script(src='/javascripts/raphael.js')
    //- style.
        html {
            height: 100%;
            padding: 0;
            margin: 0;
        }
        body {
            position: absolute;
            top: 0;
            left: 0;
            padding: 0;
            margin: 0;
            width: 100%;
            height: 100%;
            min-width: 100%;
        }

    script.

        window.onload = function() {
            var W = 1000,
                H = 480,
                r = Raphael("raphHolder", W, H),
                values = [[],[],[],[],[],[],[],[]],
                len = 8;

            // Data storage    
            for (var i = len; i--;) {
                for (var j = len; j--;){
                    values[j].push(0);
                }
            }

            // Note selectors
            for (var i = len; i--;) {
                for (var j = len; j--;){
                    r.circle(40+100*i,40+100*j, 15)
                    .attr({fill: "#199", stroke: "#000", 'stroke-width': 2, 'fill-opacity': values[j][i], 'stroke-opacity': 0.75})
                    .data('x', i)
                    .data('y',j)
                    .click(function () {
                        var new_op = +!this.attr('fill-opacity');
                        values[this.data('y')][this.data('x')] = new_op;                        
                        this.animate({'fill-opacity' : new_op}, 200);
                    })
                    .mouseover(function() {
                        this.animate({'stroke-opacity' : 1}, 100);
                    })
                    .mouseout(function() {
                        this.animate({'stroke-opacity' : 0.75}, 100);
                    });
                }
            }

            // Submit button
            r.circle(100, 100, 30)
                .attr({fill: "#199", stroke: "#000", 'stroke-width': 2, 'fill-opacity': 0, 'stroke-opacity': 1})
                .click(function() {
                        document.getElementById('glass0').value = values.join('');
                        document.getElementById('newSong').submit();
                    });
            
        };


block content

    div(id="raphHolder")
    div(id="formHolder")
        form(id="newSong", method="post", action="/submit")
            input(id="glass0", type="hidden", name="glass0")
    //- div(id="footer")
        | <b><a href='http://github.com/jacobkingery/GhostFiddle' style='color: #111;'>Team Ghost Fiddle</a></b>
